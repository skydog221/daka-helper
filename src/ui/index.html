<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>打卡剪辑助手</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- 标题栏 -->
      <header class="header">
        <h1>🎵 打卡剪辑助手</h1>
        <p class="subtitle">快速重复拼接音频到指定时间</p>
        
        <!-- 模式切换器 -->
        <div class="mode-switcher">
          <button class="mode-btn active" data-mode="record" id="modeRecord">🎙️ 录音模式</button>
          <button class="mode-btn" data-mode="upload" id="modeUpload">📁 上传模式</button>
        </div>
      </header>

      <!-- 主要内容区域 -->
      <main class="main-content">
        <!-- 录音功能区域 -->
        <section class="recording-section">
          <h2>录音功能</h2>
          
          <!-- 录音状态显示 -->
          <div id="recording-status">
            <span id="recording-state">未开始录音</span>
            <span id="recording-duration">00:00:00</span>
          </div>
          
          <!-- 录音波形可视化 -->
          <div id="waveform-visualizer">
            <canvas id="waveform-canvas"></canvas>
          </div>
          
          <!-- 录音控制按钮 -->
          <div id="recording-controls">
            <button id="btn-start-recording" class="btn btn-primary">开始录音</button>
            <button id="btn-pause-recording" class="btn btn-secondary" disabled>暂停</button>
            <button id="btn-stop-recording" class="btn btn-danger" disabled>停止</button>
          </div>
          
          <!-- 录音信息 -->
          <div id="recording-info" class="info-box" style="display: none;">
            <p>文件大小: <span id="recording-size">-</span></p>
          </div>
        </section>

        <!-- 文件选择区域 -->
        <section class="file-section">
          <div class="file-upload-area" id="fileUploadArea">
            <div class="upload-icon">📁</div>
            <p class="upload-text">点击选择音频文件</p>
            <p class="upload-hint">支持 MP3、WAV、FLAC、M4A、AAC、OGG 格式</p>
            <button class="select-file-btn" id="selectFileBtn">选择文件</button>
          </div>

          <!-- 文件信息显示 -->
          <div class="file-info" id="fileInfo" style="display: none">
            <div class="file-details">
              <h3 id="fileName">文件名</h3>
              <div class="file-meta">
                <span id="fileSize">文件大小</span>
                <span id="fileDuration">时长</span>
                <span id="fileFormat">格式</span>
              </div>
            </div>
            <button class="change-file-btn" id="changeFileBtn">更换文件</button>
          </div>
        </section>

        <!-- 设置区域 -->
        <section class="settings-section">
          <h2>处理设置</h2>

          <!-- 目标时间设置 -->
          <div class="setting-group">
            <label>目标时长</label>
            <div class="time-input-group">
              <div class="time-input-field">
                <label for="targetMinutes" class="time-label">分钟</label>
                <input
                  type="number"
                  id="targetMinutes"
                  min="0"
                  max="999"
                  value="10"
                  placeholder="0"
                />
              </div>
              <span class="time-separator">:</span>
              <div class="time-input-field">
                <label for="targetSeconds" class="time-label">秒</label>
                <input
                  type="number"
                  id="targetSeconds"
                  min="0"
                  max="59"
                  value="0"
                  placeholder="0"
                />
              </div>
            </div>
          </div>

          <!-- 随机延长设置 -->
          <div class="setting-group">
            <div class="checkbox-group">
              <input type="checkbox" id="randomExtend" checked />
              <label for="randomExtend">随机延长</label>
            </div>
            <div
              class="random-range-group"
              id="randomRangeGroup"
              style="display: block"
            >
              <label for="randomRange">最大延长秒数</label>
              <input
                type="number"
                id="randomRange"
                min="0"
                max="300"
                value="30"
              />
              <span class="range-hint">在目标时长基础上随机增加 0-30 秒</span>
            </div>
          </div>

          <!-- 输出格式设置 -->
          <div class="setting-group">
            <label for="outputFormat">输出格式</label>
            <select id="outputFormat">
              <option value="wav">WAV (无损)</option>
            </select>
          </div>
        </section>

        <!-- 处理按钮和进度 -->
        <section class="process-section">
          <button class="process-btn" id="processBtn" disabled>
            <span class="btn-icon">🚀</span>
            <span class="btn-text">开始处理</span>
          </button>

          <!-- 进度显示 -->
          <div
            class="progress-container"
            id="progressContainer"
            style="display: none"
          >
            <div class="progress-info">
              <span id="progressStage">准备中...</span>
              <span id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
          </div>

          <!-- 结果显示 -->
          <div
            class="result-container"
            id="resultContainer"
            style="display: none"
          >
            <div class="result-success">
              <div class="success-icon">✅</div>
              <h3>处理完成！</h3>
              <p id="resultMessage">音频文件已成功处理</p>
              <div class="result-actions">
                <button class="result-btn" id="openFolderBtn">
                  打开文件夹
                </button>
                <button class="result-btn secondary" id="processAnotherBtn">
                  处理其他文件
                </button>
              </div>
            </div>
          </div>

          <!-- 错误显示 -->
          <div
            class="error-container"
            id="errorContainer"
            style="display: none"
          >
            <div class="error-message">
              <div class="error-icon">❌</div>
              <h3>处理失败</h3>
              <p id="errorMessage">发生了未知错误</p>
              <button class="error-btn" id="retryBtn">重试</button>
            </div>
          </div>
        </section>
      </main>

      <!-- 底部信息 -->
      <footer class="footer">
        <p>© 2025 打卡剪辑助手 - 让音频处理更简单</p>
      </footer>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>